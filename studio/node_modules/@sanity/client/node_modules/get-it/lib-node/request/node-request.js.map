{"version":3,"file":"node-request.js","names":["qs","require","url","http","https","concat","follow","timedOut","isStream","toStream","progressStream","decompressResponse","getProxyOptions","rewriteUriForProxy","tunneling","adapter","reduceResponse","res","reqUrl","method","body","headers","statusCode","statusMessage","module","exports","context","cb","options","uri","Object","assign","parse","bodyType","Buffer","isBuffer","Error","lengthHeader","bodySize","byteLength","aborted","callback","err","channels","abort","subscribe","reqOpts","lowerCaseHeaders","maxRedirects","proxy","tunnel","shouldEnable","injectedResponse","applyMiddleware","undefined","cbTimer","setImmediate","clearImmediate","applyAgent","auth","username","password","split","map","item","unescape","from","authBase64","toString","transport","getRequestTransport","debug","agent","host","port","tryCompressed","compress","finalOptions","request","response","resStream","responseUrl","stream","data","rawBody","reduced","timeout","once","bodyStream","progress","getProgressStream","pipe","end","bodyIsStream","length","time","isHttpsRequest","protocol","transports","isHttpsProxy","test","keys","reduce","acc","header","toLowerCase"],"sources":["../../src/request/node-request.js"],"sourcesContent":["/* eslint-disable no-process-env */\nconst qs = require('querystring')\nconst url = require('url')\nconst http = require('http')\nconst https = require('https')\nconst concat = require('simple-concat')\nconst follow = require('follow-redirects')\nconst timedOut = require('@sanity/timed-out')\nconst isStream = require('is-stream')\nconst toStream = require('into-stream')\nconst progressStream = require('progress-stream')\nconst decompressResponse = require('decompress-response')\nconst {getProxyOptions, rewriteUriForProxy} = require('./node/proxy')\nconst tunneling = require('./node/tunnel')\n\nconst adapter = 'node'\n\n// Reduce a fully fledged node-style response object to\n// something that works in both browser and node environment\nconst reduceResponse = (res, reqUrl, method, body) => ({\n  body,\n  url: reqUrl,\n  method: method,\n  headers: res.headers,\n  statusCode: res.statusCode,\n  statusMessage: res.statusMessage\n})\n\nmodule.exports = (context, cb) => {\n  const options = context.options\n  const uri = Object.assign({}, url.parse(options.url))\n  const bodyType = isStream(options.body) ? 'stream' : typeof options.body\n\n  if (\n    bodyType !== 'undefined' &&\n    bodyType !== 'stream' &&\n    bodyType !== 'string' &&\n    !Buffer.isBuffer(options.body)\n  ) {\n    throw new Error(`Request body must be a string, buffer or stream, got ${bodyType}`)\n  }\n\n  const lengthHeader = {}\n  if (options.bodySize) {\n    lengthHeader['content-length'] = options.bodySize\n  } else if (options.body && bodyType !== 'stream') {\n    lengthHeader['content-length'] = Buffer.byteLength(options.body)\n  }\n\n  // Make sure callback is not called in the event of a cancellation\n  let aborted = false\n  const callback = (err, res) => !aborted && cb(err, res)\n  context.channels.abort.subscribe(() => {\n    aborted = true\n  })\n\n  // Create a reduced subset of options meant for the http.request() method\n  let reqOpts = Object.assign({}, uri, {\n    method: options.method,\n    headers: Object.assign({}, lowerCaseHeaders(options.headers), lengthHeader),\n    maxRedirects: options.maxRedirects\n  })\n\n  // Figure out proxying/tunnel options\n  const proxy = getProxyOptions(options)\n  const tunnel = proxy && tunneling.shouldEnable(options)\n\n  // Allow middleware to inject a response, for instance in the case of caching or mocking\n  const injectedResponse = context.applyMiddleware('interceptRequest', undefined, {\n    adapter,\n    context\n  })\n\n  // If middleware injected a response, treat it as we normally would and return it\n  // Do note that the injected response has to be reduced to a cross-environment friendly response\n  if (injectedResponse) {\n    const cbTimer = setImmediate(callback, null, injectedResponse)\n    const abort = () => clearImmediate(cbTimer)\n    return {abort}\n  }\n\n  // We're using the follow-redirects module to transparently follow redirects\n  if (options.maxRedirects !== 0) {\n    reqOpts.maxRedirects = options.maxRedirects || 5\n  }\n\n  // Apply currect options for proxy tunneling, if enabled\n  if (proxy && tunnel) {\n    reqOpts = tunneling.applyAgent(reqOpts, proxy)\n  } else if (proxy && !tunnel) {\n    reqOpts = rewriteUriForProxy(reqOpts, uri, proxy)\n  }\n\n  // Handle proxy authorization if present\n  if (!tunnel && proxy && proxy.auth && !reqOpts.headers['proxy-authorization']) {\n    const [username, password] = proxy.auth.username\n      ? [proxy.auth.username, proxy.auth.password]\n      : proxy.auth.split(':').map(item => qs.unescape(item))\n\n    const auth = Buffer.from(`${username}:${password}`, 'utf8')\n    const authBase64 = auth.toString('base64')\n    reqOpts.headers['proxy-authorization'] = `Basic ${authBase64}`\n  }\n\n  // Figure out transport (http/https, forwarding/non-forwarding agent)\n  const transport = getRequestTransport(reqOpts, proxy, tunnel)\n  if (typeof options.debug === 'function' && proxy) {\n    options.debug(\n      'Proxying using %s',\n      reqOpts.agent ? 'tunnel agent' : `${reqOpts.host}:${reqOpts.port}`\n    )\n  }\n\n  // See if we should try to request a compressed response (and decompress on return)\n  const tryCompressed = reqOpts.method !== 'HEAD'\n  if (tryCompressed && !reqOpts.headers['accept-encoding'] && options.compress !== false) {\n    reqOpts.headers['accept-encoding'] = 'br, gzip, deflate'\n  }\n\n  const finalOptions = context.applyMiddleware('finalizeOptions', reqOpts)\n  const request = transport.request(finalOptions, response => {\n    const res = tryCompressed ? decompressResponse(response) : response\n    const resStream = context.applyMiddleware('onHeaders', res, {\n      headers: response.headers,\n      adapter,\n      context\n    })\n\n    // On redirects, `responseUrl` is set\n    const reqUrl = response.responseUrl || options.url\n\n    if (options.stream) {\n      callback(null, reduceResponse(res, reqUrl, reqOpts.method, resStream))\n      return\n    }\n\n    // Concatenate the response body, then parse the response with middlewares\n    concat(resStream, (err, data) => {\n      if (err) {\n        return callback(err)\n      }\n\n      const body = options.rawBody ? data : data.toString()\n      const reduced = reduceResponse(res, reqUrl, reqOpts.method, body)\n      return callback(null, reduced)\n    })\n  })\n\n  if (options.timeout) {\n    timedOut(request, options.timeout)\n  }\n\n  request.once('error', callback)\n\n  // Cheating a bit here; since we're not concerned about the \"bundle size\" in node,\n  // and modifying the body stream would be sorta tricky, we're just always going\n  // to put a progress stream in the middle here. Note that\n  const {bodyStream, progress} = getProgressStream(options)\n\n  // Let middleware know we're about to do a request\n  context.applyMiddleware('onRequest', {options, adapter, request, context, progress})\n\n  if (bodyStream) {\n    bodyStream.pipe(request)\n  } else {\n    request.end(options.body)\n  }\n\n  return {abort: () => request.abort()}\n}\n\nfunction getProgressStream(options) {\n  if (!options.body) {\n    return {}\n  }\n\n  const bodyIsStream = isStream(options.body)\n  const length = options.bodySize || (bodyIsStream ? null : Buffer.byteLength(options.body))\n  if (!length) {\n    return bodyIsStream ? {bodyStream: options.body} : {}\n  }\n\n  const progress = progressStream({time: 16, length})\n  const bodyStream = bodyIsStream ? options.body : toStream(options.body)\n  return {bodyStream: bodyStream.pipe(progress), progress}\n}\n\nfunction getRequestTransport(reqOpts, proxy, tunnel) {\n  const isHttpsRequest = reqOpts.protocol === 'https:'\n  const transports =\n    reqOpts.maxRedirects === 0\n      ? {http: http, https: https}\n      : {http: follow.http, https: follow.https}\n\n  if (!proxy || tunnel) {\n    return isHttpsRequest ? transports.https : transports.http\n  }\n\n  // Assume the proxy is an HTTPS proxy if port is 443, or if there is a\n  // `protocol` option set that starts with https\n  let isHttpsProxy = proxy.port === 443\n  if (proxy.protocol) {\n    isHttpsProxy = /^https:?/.test(proxy.protocol)\n  }\n\n  return isHttpsProxy ? transports.https : transports.http\n}\n\nfunction lowerCaseHeaders(headers) {\n  return Object.keys(headers || {}).reduce((acc, header) => {\n    acc[header.toLowerCase()] = headers[header]\n    return acc\n  }, {})\n}\n"],"mappings":"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"}