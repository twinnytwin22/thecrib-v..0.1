{"version":3,"file":"observable.js","names":["opts","Observable","implementation","global","Error","onReturn","channels","context","observer","error","subscribe","err","progress","event","next","Object","assign","type","response","complete","request","publish","abort"],"sources":["../../src/middleware/observable.js"],"sourcesContent":["import global from '../util/global'\n\nexport default (opts = {}) => {\n  const Observable = opts.implementation || global.Observable\n  if (!Observable) {\n    throw new Error(\n      '`Observable` is not available in global scope, and no implementation was passed'\n    )\n  }\n\n  return {\n    onReturn: (channels, context) =>\n      new Observable(observer => {\n        channels.error.subscribe(err => observer.error(err))\n        channels.progress.subscribe(event =>\n          observer.next(Object.assign({type: 'progress'}, event))\n        )\n        channels.response.subscribe(response => {\n          observer.next(Object.assign({type: 'response'}, response))\n          observer.complete()\n        })\n\n        channels.request.publish(context)\n        return () => channels.abort.publish()\n      })\n  }\n}\n"],"mappings":";;;;;;;AAAA;;;;eAEe,CAACA,IAAI,GAAG,EAAR,KAAe;EAC5B,MAAMC,UAAU,GAAGD,IAAI,CAACE,cAAL,IAAuBC,eAAA,CAAOF,UAAjD;;EACA,IAAI,CAACA,UAAL,EAAiB;IACf,MAAM,IAAIG,KAAJ,CACJ,iFADI,CAAN;EAGD;;EAED,OAAO;IACLC,QAAQ,EAAE,CAACC,QAAD,EAAWC,OAAX,KACR,IAAIN,UAAJ,CAAeO,QAAQ,IAAI;MACzBF,QAAQ,CAACG,KAAT,CAAeC,SAAf,CAAyBC,GAAG,IAAIH,QAAQ,CAACC,KAAT,CAAeE,GAAf,CAAhC;MACAL,QAAQ,CAACM,QAAT,CAAkBF,SAAlB,CAA4BG,KAAK,IAC/BL,QAAQ,CAACM,IAAT,CAAcC,MAAM,CAACC,MAAP,CAAc;QAACC,IAAI,EAAE;MAAP,CAAd,EAAkCJ,KAAlC,CAAd,CADF;MAGAP,QAAQ,CAACY,QAAT,CAAkBR,SAAlB,CAA4BQ,QAAQ,IAAI;QACtCV,QAAQ,CAACM,IAAT,CAAcC,MAAM,CAACC,MAAP,CAAc;UAACC,IAAI,EAAE;QAAP,CAAd,EAAkCC,QAAlC,CAAd;QACAV,QAAQ,CAACW,QAAT;MACD,CAHD;MAKAb,QAAQ,CAACc,OAAT,CAAiBC,OAAjB,CAAyBd,OAAzB;MACA,OAAO,MAAMD,QAAQ,CAACgB,KAAT,CAAeD,OAAf,EAAb;IACD,CAZD;EAFG,CAAP;AAgBD,C"}