{"version":3,"file":"observable.js","names":["opts","Observable","implementation","global","Error","onReturn","channels","context","observer","error","subscribe","err","progress","event","next","type","response","complete","request","publish","abort"],"sources":["../../src/middleware/observable.js"],"sourcesContent":["import global from '../util/global'\n\nexport default (opts = {}) => {\n  const Observable = opts.implementation || global.Observable\n  if (!Observable) {\n    throw new Error(\n      '`Observable` is not available in global scope, and no implementation was passed'\n    )\n  }\n\n  return {\n    onReturn: (channels, context) =>\n      new Observable(observer => {\n        channels.error.subscribe(err => observer.error(err))\n        channels.progress.subscribe(event =>\n          observer.next(Object.assign({type: 'progress'}, event))\n        )\n        channels.response.subscribe(response => {\n          observer.next(Object.assign({type: 'response'}, response))\n          observer.complete()\n        })\n\n        channels.request.publish(context)\n        return () => channels.abort.publish()\n      })\n  }\n}\n"],"mappings":";;;;;;;AAAA;;;;;;eAEe,oBAAe;EAAA,IAAdA,IAAc,uEAAP,EAAO;EAC5B,IAAMC,UAAU,GAAGD,IAAI,CAACE,cAAL,IAAuBC,eAAA,CAAOF,UAAjD;;EACA,IAAI,CAACA,UAAL,EAAiB;IACf,MAAM,IAAIG,KAAJ,CACJ,iFADI,CAAN;EAGD;;EAED,OAAO;IACLC,QAAQ,EAAE,kBAACC,QAAD,EAAWC,OAAX;MAAA,OACR,IAAIN,UAAJ,CAAe,UAAAO,QAAQ,EAAI;QACzBF,QAAQ,CAACG,KAAT,CAAeC,SAAf,CAAyB,UAAAC,GAAG;UAAA,OAAIH,QAAQ,CAACC,KAAT,CAAeE,GAAf,CAAJ;QAAA,CAA5B;QACAL,QAAQ,CAACM,QAAT,CAAkBF,SAAlB,CAA4B,UAAAG,KAAK;UAAA,OAC/BL,QAAQ,CAACM,IAAT,CAAc,SAAc;YAACC,IAAI,EAAE;UAAP,CAAd,EAAkCF,KAAlC,CAAd,CAD+B;QAAA,CAAjC;QAGAP,QAAQ,CAACU,QAAT,CAAkBN,SAAlB,CAA4B,UAAAM,QAAQ,EAAI;UACtCR,QAAQ,CAACM,IAAT,CAAc,SAAc;YAACC,IAAI,EAAE;UAAP,CAAd,EAAkCC,QAAlC,CAAd;UACAR,QAAQ,CAACS,QAAT;QACD,CAHD;QAKAX,QAAQ,CAACY,OAAT,CAAiBC,OAAjB,CAAyBZ,OAAzB;QACA,OAAO;UAAA,OAAMD,QAAQ,CAACc,KAAT,CAAeD,OAAf,EAAN;QAAA,CAAP;MACD,CAZD,CADQ;IAAA;EADL,CAAP;AAgBD,C"}